{
  "version": 1,
  "generated_at": "2025-12-24",
  "scripts_by_plan": {
    "GEAP": {
      "AMBOS": "void setTimeout(async () => {\ntry {\n  const codigos = [\"40301087\",\"40301150\",\"40301222\",\"40301281\",\"40316211\",\"40316157\",\"40301354\",\"40301362\",\"40301397\",\"40301419\",\"40301648\",\"40704076\",\"40301630\",\"40316246\",\"40316262\",\"40316270\",\"40301842\",\"40301427\",\"40302520\",\"40301931\",\"40316289\",\"40316300\",\"40302075\",\"40304361\",\"40302113\",\"40316360\",\"40301729\",\"40316335\",\"40302199\",\"40302237\",\"40302750\",\"40316408\",\"40316416\",\"40308391\",\"40302385\",\"40305627\",\"40316467\",\"40316556\",\"40316521\",\"40316548\",\"40316491\",\"40316483\",\"40316513\",\"40316505\",\"40312151\",\"40302580\",\"40316530\",\"40316572\",\"40302830\",\"40301958\",\"40316165\",\"40302687\",\"40302601\",\"40302610\",\"40302849\",\"40305465\",\"40302318\",\"40304507\",\"40302377\",\"40314103\",\"40313301\"];\n  const delay = ms => new Promise(r => setTimeout(r, ms));\n\n  const toggle = document.querySelector(\"a[href='#collapse2']\");\n  const div2   = document.getElementById(\"collapse2\");\n  if (toggle && div2 && !div2.classList.contains(\"in\")) {\n    toggle.click(); await delay(2000);\n  }\n\n  let primeira;\n  for (let i=0; i<50; i++) {\n    primeira = document.getElementsByName(\"item_medico_1\")[0];\n    if (primeira) break;\n    await delay(100);\n  }\n  if (!primeira) {\n    console.error(\"‚ùå Timeout aguardando item_medico_1\");\n    return;\n  }\n\n  for (let i = 0; i < codigos.length; i++) {\n    const idx = i + 1;\n    const code = codigos[i];\n\n    if (idx > 1) {\n      const btn = document.getElementById(\"button2\");\n      if (btn) { btn.click(); await delay(500); }\n    }\n\n    const campo = document.getElementsByName(`item_medico_${idx}`)[0];\n    if (campo) {\n      campo.value = code;\n      campo.dispatchEvent(new Event(\"input\",{bubbles:true}));\n      campo.dispatchEvent(new Event(\"change\",{bubbles:true}));\n    }\n\n    const qtd = document.getElementsByName(`qtd_solicitada_${idx}`)[0];\n    if (qtd) {\n      qtd.value = \"1\";\n      qtd.dispatchEvent(new Event(\"input\",{bubbles:true}));\n      qtd.dispatchEvent(new Event(\"change\",{bubbles:true}));\n    }\n\n    console.log(`‚úÖ Inserido ${code} no campo ${idx}`);\n    await delay(1000);\n\n    const modal = document.getElementById(\"modalDadosBiometria\");\n    if (modal && modal.classList.contains(\"in\")) {\n      const chk = document.getElementById(\"validacaoCelularEmail\");\n      if (chk && !chk.checked) chk.click();\n      const ok = document.getElementById(\"btnModalDadosBiometria\");\n      if (ok) ok.click();\n      let count = 0;\n      while (modal.classList.contains(\"in\") && count < 20) {\n        await delay(200); count++;\n      }\n    }\n\n    await delay(6000);\n  }\n\n  console.log(\"üéâ Todos os c√≥digos foram inseridos!\");\n} catch (e) {\n  console.error(\"‚ùå Erro fatal no script:\", e);\n}\n}, 0);"
    },
    "CASEMBRAPA": {
      "AMBOS": "void setTimeout(async () => {\ntry {\n  const codigos = [\"40301087\",\"40301150\",\"40301222\",\"40301281\",\"40316211\",\"40316157\",\"40301354\",\"40301362\",\"40301397\",\"40301419\",\"40301648\",\"40704076\",\"40301630\",\"40316246\",\"40316262\",\"40316270\",\"40301842\",\"40301427\",\"40302520\",\"40301931\",\"40316289\",\"40316300\",\"40302075\",\"40304361\",\"40302113\",\"40316360\",\"40301729\",\"40316335\",\"40302199\",\"40302237\",\"40302750\",\"40316408\",\"40316416\",\"40308391\",\"40302385\",\"40305627\",\"40316467\",\"40316556\",\"40316521\",\"40316548\",\"40316491\",\"40316483\",\"40316513\",\"40316505\",\"40312151\",\"40302580\",\"40316530\",\"40316572\",\"40302830\",\"40301958\",\"40316165\",\"40302687\",\"40302601\",\"40302610\",\"40302849\",\"40305465\",\"40302318\",\"40304507\",\"40302377\",\"40314103\",\"40313301\"];\n  const delay = ms => new Promise(r => setTimeout(r, ms));\n  const gridId = \"gridSolicitacao_gridProcedimentosSimples\";\n  const grid = document.getElementById(gridId);\n  if (!grid) { console.error(\"‚ùå Grid n√£o encontrada\"); return; }\n\n  let btnInsert = grid.querySelector(\"#insertButton\");\n  let btnPost   = grid.querySelector(\"#postButton\");\n\n  const click = async el => {\n    if(!el) return false;\n    el.scrollIntoView?.({block:\"center\"});\n    el.dispatchEvent(new MouseEvent(\"mousedown\",{bubbles:true}));\n    el.click();\n    el.dispatchEvent(new MouseEvent(\"mouseup\",{bubbles:true}));\n    await delay(150);\n    return true;\n  };\n\n  const getRows     = () => Array.from(grid.querySelectorAll(\"tr.grid-record.tableView\"));\n  const getMaxRowId = () => getRows().reduce((m,tr)=>Number.isFinite(+tr.id)?Math.max(m,+tr.id):m,-1);\n  const getRecCount = () => parseInt(grid.querySelector(`#${gridId}_gridPosition_rec_count`)?.textContent||\"0\",10);\n\n  async function waitNewRow(oldMax, oldRec) {\n    for(let k=0;k<40;k++) {\n      const nMax = getMaxRowId(), nRec = getRecCount();\n      if ((Number.isFinite(nMax) && nMax>oldMax) || (nRec && nRec>oldRec)) return true;\n      await delay(100);\n    }\n    return false;\n  }\n\n  async function pressEnter(el) {\n    if(!el) return;\n    el.focus?.();\n    const fire = type => el.dispatchEvent(new KeyboardEvent(type,{\n      bubbles:true,cancelable:true,key:\"Enter\",code:\"Enter\",keyCode:13,which:13\n    }));\n    fire(\"keydown\"); fire(\"keypress\"); fire(\"keyup\");\n    el.dispatchEvent(new Event(\"change\",{bubbles:true}));\n    await delay(150);\n    el.blur?.();\n    await delay(150);\n  }\n\n  async function ensureCellEditorInRow(tr, fieldname) {\n    if (!tr) return null;\n    const td = tr.querySelector(`td.grid-cell.tableView[fieldname='${fieldname}']`);\n    if (!td) return null;\n    for(let i=0;i<10;i++) {\n      try {\n        parent?.Input?.prepareCellEdition?.(gridId, td);\n        parent?.Input?.handleDoubleClickEvent?.(td, gridId, fieldname);\n      } catch(_){}\n      td.dispatchEvent(new MouseEvent(\"click\",{bubbles:true}));\n      td.dispatchEvent(new MouseEvent(\"dblclick\",{bubbles:true}));\n      await delay(60);\n      const inp = tr.querySelector(`input[name='${fieldname}'].editingRecord`);\n      if (inp) return inp;\n    }\n    return null;\n  }\n\n  async function confirmarLinha() {\n    btnPost = grid.querySelector(\"#postButton\") || btnPost;\n    await click(btnPost);\n    try { parent?.Grid?.postRecord?.(gridId); } catch(_){}\n    await delay(400);\n    [\"keydown\",\"keypress\",\"keyup\"].forEach(t=>document.dispatchEvent(\n      new KeyboardEvent(t,{bubbles:true,key:\"m\",code:\"KeyM\",keyCode:77,which:77,ctrlKey:true})\n    ));\n    await delay(150);\n  }\n\n  for (let idx = 0; idx < codigos.length; idx++) {\n    const code = codigos[idx];\n    console.log(`‚ñ∂Ô∏è Inserindo c√≥digo ${idx+1}/${codigos.length}: ${code}`);\n\n    const maxAntes = getMaxRowId(), recAntes = getRecCount();\n\n    for(let i=0;i<3;i++) {\n      const ok = await click(btnInsert);\n      if (ok) {\n        const active = btnInsert.classList.contains(\"grid-titleBar-newRecordButton-active\");\n        if(active) break;\n      }\n      await delay(250);\n    }\n\n    await delay(250);\n\n    const newRow = await waitNewRow(maxAntes, recAntes);\n    const tr = newRow\n      ? grid.querySelector(`tr.grid-record.tableView[id='${getMaxRowId()}']`)\n      : getRows().slice(-1)[0];\n\n    if (!tr) { console.error(\"‚ùå N√£o foi poss√≠vel identificar a nova linha.\"); break; }\n\n    const tab = await ensureCellEditorInRow(tr,\"TABELACOBRANCA\");\n    if (tab) {\n      tab.value = \"22\";\n      tab.dispatchEvent(new Event(\"input\",{bubbles:true}));\n      await pressEnter(tab);\n    }\n\n    const proc = await ensureCellEditorInRow(tr,\"PROCEDIMENTO\");\n    if (!proc) { console.error(\"‚ùå Campo PROCEDIMENTO n√£o encontrado para\", code); break; }\n    proc.value = code;\n    proc.dispatchEvent(new Event(\"input\",{bubbles:true}));\n    await pressEnter(proc);\n\n    for (let tent = 0; tent < 3; tent++) {\n      const qtd = await ensureCellEditorInRow(tr,\"COBRADOQDE\");\n      if (qtd) {\n        qtd.focus();\n        qtd.select?.();\n        qtd.value = \"1\";\n        qtd.title = \"1\";\n        qtd.dispatchEvent(new Event(\"input\",{bubbles:true}));\n        await pressEnter(qtd);\n        await delay(150);\n        if (qtd.value === \"1\" || qtd.title === \"1\") break;\n      }\n      await delay(200);\n    }\n\n    await confirmarLinha();\n    await delay(120);\n    console.log(\"‚úÖ Linha confirmada:\", code);\n  }\n\n  console.log(\"üéâ Conclu√≠do: todos os c√≥digos processados com sucesso!\");\n} catch(e) {\n  console.error(\"‚ùå Erro fatal no script:\", e);\n}\n}, 0);"
    },
    "NovaSaude": {
      "Ambos": "void setTimeout(async () => {\ntry {\n  const codigos = [\"40301087\",\"40301150\",\"40301222\",\"40301281\",\"40316211\",\"40316157\",\"40301354\",\"40301362\",\"40301397\",\"40301419\",\"40301648\",\"40704076\",\"40301630\",\"40316246\",\"40316262\",\"40316270\",\"40301842\",\"40301427\",\"40302520\",\"40301931\",\"40316289\",\"40316300\",\"40302075\",\"40304361\",\"40302113\",\"40316360\",\"40301729\",\"40316335\",\"40302199\",\"40302237\",\"40302750\",\"40316408\",\"40316416\",\"40308391\",\"40302385\",\"40305627\",\"40316467\",\"40316556\",\"40316521\",\"40316548\",\"40316491\",\"40316483\",\"40316513\",\"40316505\",\"40312151\",\"40302580\",\"40316530\",\"40316572\",\"40302830\",\"40301958\",\"40316165\",\"40302687\",\"40302601\",\"40302610\",\"40302849\",\"40305465\",\"40302318\",\"40304507\",\"40302377\",\"40314103\",\"40313301\"];\n  const delay = ms => new Promise(r => setTimeout(r, ms));\n\n  const toggle = document.querySelector(\"a[href='#collapse2']\");\n  const div2   = document.getElementById(\"collapse2\");\n  if (toggle && div2 && !div2.classList.contains(\"in\")) {\n    toggle.click(); await delay(2000);\n  }\n\n  let primeira;\n  for (let i=0; i<50; i++) {\n    primeira = document.getElementsByName(\"item_medico_1\")[0];\n    if (primeira) break;\n    await delay(100);\n  }\n  if (!primeira) {\n    console.error(\"‚ùå Timeout aguardando item_medico_1\");\n    return;\n  }\n\n  for (let i = 0; i < codigos.length; i++) {\n    const idx = i + 1;\n    const code = codigos[i];\n\n    if (idx > 1) {\n      const btn = document.getElementById(\"button2\");\n      if (btn) { btn.click(); await delay(500); }\n    }\n\n    const campo = document.getElementsByName(`item_medico_${idx}`)[0];\n    if (campo) {\n      campo.value = code;\n      campo.dispatchEvent(new Event(\"input\",{bubbles:true}));\n      campo.dispatchEvent(new Event(\"change\",{bubbles:true}));\n    }\n\n    const qtd = document.getElementsByName(`qtd_solicitada_${idx}`)[0];\n    if (qtd) {\n      qtd.value = \"1\";\n      qtd.dispatchEvent(new Event(\"input\",{bubbles:true}));\n      qtd.dispatchEvent(new Event(\"change\",{bubbles:true}));\n    }\n\n    console.log(`‚úÖ Inserido ${code} no campo ${idx}`);\n    await delay(1000);\n\n    const modal = document.getElementById(\"modalDadosBiometria\");\n    if (modal && modal.classList.contains(\"in\")) {\n      const chk = document.getElementById(\"validacaoCelularEmail\");\n      if (chk && !chk.checked) chk.click();\n      const ok = document.getElementById(\"btnModalDadosBiometria\");\n      if (ok) ok.click();\n      let count = 0;\n      while (modal.classList.contains(\"in\") && count < 20) {\n        await delay(200); count++;\n      }\n    }\n\n    await delay(6000);\n  }\n\n  console.log(\"üéâ Todos os c√≥digos foram inseridos!\");\n} catch (e) {\n  console.error(\"‚ùå Erro fatal no script:\", e);\n}\n}, 0);"
    },
    "GamaSaude": {
      "Ambos": "void setTimeout(async () => {\ntry {\n  const codigos = [\"40301087\",\"40301150\",\"40301222\",\"40301281\",\"40316211\",\"40316157\",\"40301354\",\"40301362\",\"40301397\",\"40301419\",\"40301648\",\"40704076\",\"40301630\",\"40316246\",\"40316262\",\"40316270\",\"40301842\",\"40301427\",\"40302520\",\"40301931\",\"40316289\",\"40316300\",\"40302075\",\"40304361\",\"40302113\",\"40316360\",\"40301729\",\"40316335\",\"40302199\",\"40302237\",\"40302750\",\"40316408\",\"40316416\",\"40308391\",\"40302385\",\"40305627\",\"40316467\",\"40316556\",\"40316521\",\"40316548\",\"40316491\",\"40316483\",\"40316513\",\"40316505\",\"40312151\",\"40302580\",\"40316530\",\"40316572\",\"40302830\",\"40301958\",\"40316165\",\"40302687\",\"40302601\",\"40302610\",\"40302849\",\"40305465\",\"40302318\",\"40304507\",\"40302377\",\"40314103\",\"40313301\"];\n  const delay = ms => new Promise(r => setTimeout(r, ms));\n\n  const toggle = document.querySelector(\"a[href='#collapse2']\");\n  const div2   = document.getElementById(\"collapse2\");\n  if (toggle && div2 && !div2.classList.contains(\"in\")) {\n    toggle.click(); await delay(2000);\n  }\n\n  let primeira;\n  for (let i=0; i<50; i++) {\n    primeira = document.getElementsByName(\"item_medico_1\")[0];\n    if (primeira) break;\n    await delay(100);\n  }\n  if (!primeira) {\n    console.error(\"‚ùå Timeout aguardando item_medico_1\");\n    return;\n  }\n\n  for (let i = 0; i < codigos.length; i++) {\n    const idx = i + 1;\n    const code = codigos[i];\n\n    if (idx > 1) {\n      const btn = document.getElementById(\"button2\");\n      if (btn) { btn.click(); await delay(500); }\n    }\n\n    const campo = document.getElementsByName(`item_medico_${idx}`)[0];\n    if (campo) {\n      campo.value = code;\n      campo.dispatchEvent(new Event(\"input\",{bubbles:true}));\n      campo.dispatchEvent(new Event(\"change\",{bubbles:true}));\n    }\n\n    const qtd = document.getElementsByName(`qtd_solicitada_${idx}`)[0];\n    if (qtd) {\n      qtd.value = \"1\";\n      qtd.dispatchEvent(new Event(\"input\",{bubbles:true}));\n      qtd.dispatchEvent(new Event(\"change\",{bubbles:true}));\n    }\n\n    console.log(`‚úÖ Inserido ${code} no campo ${idx}`);\n    await delay(1000);\n\n    const modal = document.getElementById(\"modalDadosBiometria\");\n    if (modal && modal.classList.contains(\"in\")) {\n      const chk = document.getElementById(\"validacaoCelularEmail\");\n      if (chk && !chk.checked) chk.click();\n      const ok = document.getElementById(\"btnModalDadosBiometria\");\n      if (ok) ok.click();\n      let count = 0;\n      while (modal.classList.contains(\"in\") && count < 20) {\n        await delay(200); count++;\n      }\n    }\n\n    await delay(6000);\n  }\n\n  console.log(\"üéâ Todos os c√≥digos foram inseridos!\");\n} catch (e) {\n  console.error(\"‚ùå Erro fatal no script:\", e);\n}\n}, 0);"
    },
    "TRT": {
      "Ambos": "(async () => {\nconst procedimentos = [\"40301087\",\"40301150\",\"40301222\",\"40301281\",\"40316211\",\"40316157\",\"40301354\",\"40301362\",\"40301397\",\"40301419\",\"40301648\",\"40704076\",\"40301630\",\"40316246\",\"40316262\",\"40316270\",\"40301842\",\"40301427\",\"40302520\",\"40301931\",\"40316289\",\"40316300\",\"40302075\",\"40304361\",\"40302113\",\"40316360\",\"40301729\",\"40316335\",\"40302199\",\"40302237\",\"40302750\",\"40316408\",\"40316416\",\"40308391\",\"40302385\",\"40305627\",\"40316467\",\"40316556\",\"40316521\",\"40316548\",\"40316491\",\"40316483\",\"40316513\",\"40316505\",\"40312151\",\"40302580\",\"40316530\",\"40316572\",\"40302830\",\"40301958\",\"40316165\",\"40302687\",\"40302601\",\"40302610\",\"40302849\",\"40305465\",\"40302318\",\"40304507\",\"40302377\",\"40314103\",\"40313301\"];\nconst wait = ms => new Promise(res => setTimeout(res, ms));\n\nfor (const code of procedimentos) {\n  try {\n    const input = document.getElementById(\"idProcedimento\");\n    if (!input) throw new Error(\"Campo idProcedimento n√£o encontrado\");\n    input.focus();\n    input.value = code;\n    input.dispatchEvent(new Event(\"input\",  { bubbles: true }));\n    input.dispatchEvent(new Event(\"change\", { bubbles: true }));\n    input.dispatchEvent(new Event(\"blur\",   { bubbles: true }));\n\n    if (window.angular) {\n      const ngEl = angular.element(input);\n      const scope = ngEl.scope();\n      if (scope) scope.$apply();\n    }\n\n    await wait(2000);\n\n    const btn = Array.from(document.querySelectorAll(\"button\"))\n      .find(b => b.textContent.trim().toLowerCase().includes(\"confirmar\"));\n    if (!btn) throw new Error(\"Bot√£o 'Confirmar' n√£o encontrado\");\n    btn.click();\n    console.log(`‚úî Inserido: ${code}`);\n    await wait(4000);\n  } catch (err) {\n    console.error(`‚úñ Falha ao inserir ${code}: ${err.message}`);\n  }\n}\n\nconsole.log(\"‚Üí Fim do script de inser√ß√£o.\");\n})();"
    },
    "TJDFT": {
      "Procedimentos": "void setTimeout(async () => {\ntry {\n  const codes = [\"40301087\",\"40301150\",\"40301222\",\"40301281\",\"40316211\",\"40316157\",\"40301354\",\"40301362\",\"40301397\",\"40301419\",\"40301648\",\"40704076\",\"40301630\",\"40316246\",\"40316262\",\"40316270\",\"40301842\",\"40301427\",\"40302520\",\"40301931\",\"40316289\",\"40316300\",\"40302075\",\"40304361\",\"40302113\",\"40316360\",\"40301729\",\"40316335\",\"40302199\",\"40302237\",\"40302750\",\"40316408\",\"40316416\",\"40308391\",\"40302385\",\"40305627\",\"40316467\",\"40316556\",\"40316521\",\"40316548\",\"40316491\",\"40316483\",\"40316513\",\"40316505\",\"40312151\",\"40302580\",\"40316530\",\"40316572\",\"40302830\",\"40301958\",\"40316165\",\"40302687\",\"40302601\",\"40302610\",\"40302849\",\"40305465\",\"40302318\",\"40304507\",\"40302377\",\"40314103\",\"40313301\"];\n  const delay = ms => new Promise(r => setTimeout(r, ms));\n  for (const code of codes) {\n    const field = document.getElementById('HandleTermo');\n    if (!field) { console.error('Campo HandleTermo n√£o encontrado'); return; }\n    field.focus();\n    field.value = '';\n    field.dispatchEvent(new Event('input', {bubbles:true}));\n    for (const ch of code) {\n      field.value += ch;\n      field.dispatchEvent(new Event('input', {bubbles:true}));\n      await delay(50);\n    }\n    field.dispatchEvent(new KeyboardEvent('keypress', {bubbles:true, key:'Enter', code:'Enter', keyCode:13, which:13}));\n    await delay(2000);\n    const row = document.querySelector('tr.dataGridRow.ng-scope');\n    if (row) {\n      row.click();\n      await delay(500);\n    } else {\n      console.warn('Primeira linha n√£o encontrada para o c√≥digo', code);\n    }\n  }\n  console.log('‚úîÔ∏è Script conclu√≠do para TJDFT');\n} catch(err) {\n  console.error(err);\n}\n}, 0);"
    }
  }
}